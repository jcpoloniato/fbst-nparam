1+5
library("survival", lib.loc="/usr/lib/R/library")
devtools::install_github("abjur/r4jurimetrics")
install.packages("devtools")
library("devtools", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.4")
devtools::install_github("abjur/r4jurimetrics")
install.packages("tidyverse")
install.packages("xml2")
install.packages("svglite")
install.packages("tidyverse")
install.packages("xml2")
#setwd('\home\joao_polo\Dropbox\Disciplinas\Mestrado\Dissertação\fbst-nparam')
source(file.choose())
#evalor modificado
ev.mod<-function(dados,phi,r,peso){
simu<-1000
n<-length(dados)
tau<-peso^(1:r)
x<-phi_barra(dados,phi,r)
aux<-evalue(x,n,tau)
q<-rep(NA, simu)
for (i in 1:simu){
q[i] <- sum(((n*rnorm(r,sd=1/sqrt(n)))/sqrt(n+tau))^2)
}
1 - mean(q < aux)
}
ev.nmod<-function(dados,phi,r,peso){
n<-length(dados)
tau<-peso^(1:r)
x<-phi_barra(dados,phi,r)
aux<-evalue(x,n,tau)
1 - pchisq(aux, df=r)
}
getwd()
#setwd('/home/joao_polo/Dropbox/Disciplinas/Mestrado/Dissertação/fbst-nparam')
source(file.choose())
setwd('/home/joao_polo/Dropbox/Disciplinas/Mestrado/Dissertação/fbst-nparam')
setwd('/home/joao_polo/Dropbox/Disciplinas/Mestrado/Dissertação/fbst-nparam')
source(funcoesuteis.R)
source('funcoesuteis.R'')
getwd()
#evalor modificado
ev.mod<-function(dados,phi,r,peso){
simu<-1000
n<-length(dados)
tau<-peso^(1:r)
x<-phi_barra(dados,phi,r)
aux<-evalue(x,n,tau)
q<-rep(NA, simu)
for (i in 1:simu){
q[i] <- sum(((n*rnorm(r,sd=1/sqrt(n)))/sqrt(n+tau))^2)
}
1 - mean(q < aux)
}
ev.nmod<-function(dados,phi,r,peso){
n<-length(dados)
tau<-peso^(1:r)
x<-phi_barra(dados,phi,r)
aux<-evalue(x,n,tau)
1 - pchisq(aux, df=r)
}
#H_0 falsa
evs<-rep(NA,1000)
nevs<-rep(NA,1000)
for (i in 1:1000){
dados<-rnorm(10000,mean=5,sd=1)
evs[i]<-ev.mod(dados,phi,50,5)
nevs[i]<-ev.nmod(dados,phi,50,5)
}
par(mfrow=c(1,2))
hist(evs)
hist(nevs)
#H_0 verdadeira
evs1<-rep(NA,1000)
nevs1<-rep(NA,1000)
for (i in 1:1000){
dados<-runif(10000)
evs1[i]<-ev.mod(dados,phi,50,5,1000)
nevs1[i]<-ev.nmod(dados,phi,50,5)
}
hist(nevs1)
hist(evs1)
#evalor nao modificado vs evalor modificado, quem ganha? sob H0 e H1.
source('funcoesuteis.R')
ev.mod<-function(dados,phi,r,peso){
simu<-1000
n<-length(dados)
tau<-peso^(1:r)
x<-phi_barra(dados,phi,r)
aux<-evalue(x,n,tau)
q<-rep(NA, simu)
for (i in 1:simu){
q[i] <- sum(((n*rnorm(r,sd=1/sqrt(n)))/sqrt(n+tau))^2)
}
1 - mean(q < aux)
}
ev.nmod<-function(dados,phi,r,peso){
n<-length(dados)
tau<-peso^(1:r)
x<-phi_barra(dados,phi,r)
aux<-evalue(x,n,tau)
1 - pchisq(aux, df=r)
}
#H_0 falsa
evs<-rep(NA,1000)
nevs<-rep(NA,1000)
for (i in 1:1000){
dados<-rnorm(10000,mean=5,sd=1)
evs[i]<-ev.mod(dados,phi,50,5)
nevs[i]<-ev.nmod(dados,phi,50,5)
}
par(mfrow=c(1,2))
hist(evs)
hist(nevs)
evm1<-rep(NA,1000)
evnm1<-rep(NA,1000)
for (i in 1:1000){
dados<-runif(10000)
evm1[i]<-ev.mod(dados,phi,50,5,1000)
evnm1[i]<-ev.nmod(dados,phi,50,5)
}
evm1<-rep(NA,1000)
evnm1<-rep(NA,1000)
for (i in 1:1000){
dados<-runif(10000)
evm1[i]<-ev.mod(dados,phi,50,5)
evnm1[i]<-ev.nmod(dados,phi,50,5)
}
hist(evm1)
hist(evnm1)
rstudioapi::versionInfo()
sessionInfo()
install.packages("tidyverse")
install.packages("tidyverse")
tidyverse::tidyverse_packages()
