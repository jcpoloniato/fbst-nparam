source(file(),)
?source()
setwd('\home\joao_polo\Dropbox\Disciplinas\Mestrado\Dissertação\fbst-nparam')
setwd('home\joao_polo\Dropbox\Disciplinas\Mestrado\Dissertação\fbst-nparam')
source(file())
source(file.choose())
estat<-function(dados, phi, r, peso){
n<-length(dados)
tau<-peso^(1:r)
x<-phi_barra(dados,phi,r)
eval<-sum((n*x/sqrt(n+tau))^2)
return(list(n,tau,eval))
}
dados<-rnorm(10000,mean=5,sd=1)
ev.mod<-function(dados,phi,r,peso){
simu<-1000
n<-length(dados)
tau<-peso^(1:r)
aux<-estat(dados,phi,r,peso)
q<-rep(NA,simu)
for (i in 1:simu){
q[i]<-sum(((n*rnorm(r,sd=1/sqrt(n)))/sqrt(n+tau))^2)
}
prob<-sum(q<aux)/simu
ev<-1-prob
return(ev)
}
ev.nmod<-function(dados,phi,r,peso){
n<-length(dados)
tau<-peso^(1:r)
aux<-estat(dados,phi,r,peso)
# x<-phi_barra(dados,phi,r)
#mu0<-rep(0,r)
#  mu<-n/(n+tau)*x
# sigma<-diag(n+tau,r)
c0<- t(mu0-mu)%*%sigma%*%(mu0-mu)
ev<-1-pchisq(aux,df=r)
return(ev)
}
evs<-rep(NA,1000)
nevs<-rep(NA,1000)
for (i in 1:1000){
dados<-rnorm(10000,mean=5,sd=1)
evs[i]<-ev.mod(dados,phi,50,5,1000)
nevs[i]<-ev.nmod(dados,phi,50,5)
}
par(mfrow=c(1,2))
hist(evs)
hist(nevs)
evs<-rep(NA,1000)
nevs<-rep(NA,1000)
for (i in 1:1000){
dados<-rnorm(10000,mean=5,sd=1)
evs[i]<-ev.mod(dados,phi,50,5)
nevs[i]<-ev.nmod(dados,phi,50,5)
}
par(mfrow=c(1,2))
hist(evs)
hist(nevs)
estat(dados,phi,r,peso)
estat(dados,phi,50,5)
estat<-function(dados, phi, r, peso){
x<-phi_barra(dados,phi,r)
eval<-sum((n*x/sqrt(n+tau))^2)
return(eval)
}
estat(dados,phi,50,5)
eval<-function(x,n,tau){
eval<-sum((n*x/sqrt(n+tau))^2)
return(eval)
}
ev.mod<-function(dados,phi,r,peso){
simu<-1000
n<-length(dados)
tau<-peso^(1:r)
x<-phi_barra(dados,phi,r)
aux<-estat(x,n,tau)
q<-rep(NA,simu)
for (i in 1:simu){
q[i]<-sum(((n*rnorm(r,sd=1/sqrt(n)))/sqrt(n+tau))^2)
}
prob<-sum(q<aux)/simu
ev<-1-prob
return(ev)
}
ev.mod<-function(dados,phi,r,peso){
simu<-1000
n<-length(dados)
tau<-peso^(1:r)
x<-phi_barra(dados,phi,r)
aux<-eval(x,n,tau)
q<-rep(NA,simu)
for (i in 1:simu){
q[i]<-sum(((n*rnorm(r,sd=1/sqrt(n)))/sqrt(n+tau))^2)
}
prob<-sum(q<aux)/simu
ev<-1-prob
return(ev)
}
evs<-rep(NA,1000)
nevs<-rep(NA,1000)
for (i in 1:1000){
dados<-rnorm(10000,mean=5,sd=1)
evs[i]<-ev.mod(dados,phi,50,5)
#nevs[i]<-ev.nmod(dados,phi,50,5)
}
par(mfrow=c(1,2))
hist(evs)
ev.nmod<-function(dados,phi,r,peso){
n<-length(dados)
tau<-peso^(1:r)
x<-phi_barra(dados,phi,r)
aux<-eval(x,n,tau)
# x<-phi_barra(dados,phi,r)
#mu0<-rep(0,r)
#  mu<-n/(n+tau)*x
# sigma<-diag(n+tau,r)
# c0<- t(mu0-mu)%*%sigma%*%(mu0-mu)
ev<-1-pchisq(aux,df=r)
return(ev)
}
evs<-rep(NA,1000)
nevs<-rep(NA,1000)
for (i in 1:1000){
dados<-rnorm(10000,mean=5,sd=1)
evs[i]<-ev.mod(dados,phi,50,5)
nevs[i]<-ev.nmod(dados,phi,50,5)
}
par(mfrow=c(1,2))
hist(evs)
hist(nevs)
